<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Dhani Tools - TikTok Downloader</title>
  <link rel="icon" type="image/png" href="/static/favicon.png">

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- SweetAlert -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  <!-- Tailwind Config -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#8b5cf6',
            dark: '#0f0f1a'
          }
        }
      }
    }
  </script>
</head>

<body class="min-h-screen bg-gradient-to-br from-black via-[#0f0f1a] to-purple-950 flex flex-col items-center justify-center px-4 text-slate-200">

  <!-- Title -->
  <h1 class="text-4xl font-extrabold mb-8 text-center tracking-tight">
    <span class="bg-gradient-to-r from-purple-400 to-fuchsia-500 bg-clip-text text-transparent">
      TikTok Downloader
    </span>
  </h1>

  <!-- Card -->
  <div class="w-full max-w-md bg-white/5 backdrop-blur-xl rounded-2xl shadow-2xl p-8 border border-white/10">

    <h2 class="text-lg font-semibold text-center mb-6 text-slate-100">
      Download Video TikTok
    </h2>

    <!-- URL -->
    <div class="mb-4">
      <label class="block text-sm mb-1 text-slate-300">
        URL TikTok
      </label>
      <div class="relative">
        <span class="absolute left-3 top-1/2 -translate-y-1/2 text-purple-400">
          <!-- Link Icon -->
          <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M13.828 10.172a4 4 0 010 5.656l-1.414 1.414a4 4 0 01-5.656-5.656l1.414-1.414M10.172 13.828a4 4 0 010-5.656l1.414-1.414a4 4 0 015.656 5.656l-1.414 1.414"/>
          </svg>
        </span>
        <input
          id="url"
          type="text"
          placeholder="https://vt.tiktok.com/..."
          class="w-full pl-11 pr-4 py-3 rounded-xl bg-black/40 border border-white/10 text-sm focus:outline-none focus:ring-2 focus:ring-purple-500 transition"
        />
      </div>
    </div>

    <!-- Format -->
    <div class="mb-6">
      <label class="block text-sm mb-1 text-slate-300">
        Format
      </label>
      <div class="relative">
        <span class="absolute left-3 top-1/2 -translate-y-1/2 text-purple-400">
          <!-- Music Icon -->
          <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M9 19V6l12-2v13"/>
            <circle cx="6" cy="18" r="3"/>
            <circle cx="18" cy="16" r="3"/>
          </svg>
        </span>
        <select
          id="format"
          class="w-full pl-11 pr-4 py-3 rounded-xl bg-black/40 border border-white/10 text-sm focus:outline-none focus:ring-2 focus:ring-purple-500 transition"
        >
          <option value="mp4">MP4 (Video)</option>
          <option value="mp3">MP3 (Audio)</option>
        </select>
      </div>
    </div>

    <!-- Button -->
    <button
      id="go"
      class="w-full flex items-center justify-center gap-2 bg-gradient-to-r from-purple-600 to-fuchsia-600 hover:from-purple-700 hover:to-fuchsia-700 text-white font-semibold py-3 rounded-xl shadow-lg transition active:scale-95"
    >
      <!-- Download Icon -->
      <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
          d="M4 16v2a2 2 0 002 2h12a2 2 0 002-2v-2M7 10l5 5 5-5M12 15V3"/>
      </svg>
      Download
    </button>

    <!-- Loading -->
    <div
      id="loading"
      class="hidden mt-4 text-center text-sm text-purple-300 animate-pulse"
    >
      Processing download...
    </div>
  </div>

  <!-- Footer -->
  <footer class="mt-10 text-center text-sm text-slate-400">
    Made with ‚ù§Ô∏è by <span class="font-semibold text-purple-400">Dhani</span>
    <br />
    <a
      href="https://github.com/DhaniKWP"
      target="_blank"
      class="inline-flex items-center gap-1 mt-1 text-purple-400 hover:text-purple-300 font-semibold transition"
    >
      <!-- GitHub Icon -->
      <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
        <path d="M12 .5C5.73.5.5 5.73.5 12c0 5.08 3.29 9.38 7.86 10.9.57.1.78-.25.78-.56v-2c-3.2.7-3.88-1.37-3.88-1.37-.53-1.34-1.3-1.7-1.3-1.7-1.06-.73.08-.72.08-.72 1.17.08 1.78 1.2 1.78 1.2 1.04 1.78 2.73 1.26 3.4.96.1-.75.4-1.26.73-1.55-2.55-.3-5.23-1.28-5.23-5.7 0-1.26.45-2.28 1.2-3.08-.12-.3-.52-1.5.12-3.12 0 0 .97-.3 3.18 1.18a11.1 11.1 0 015.8 0c2.2-1.48 3.18-1.18 3.18-1.18.64 1.62.24 2.82.12 3.12.75.8 1.2 1.82 1.2 3.08 0 4.43-2.68 5.4-5.24 5.69.42.36.8 1.08.8 2.18v3.23c0 .31.21.67.79.56A10.5 10.5 0 0023.5 12C23.5 5.73 18.27.5 12 .5z"/>
      </svg>
      GitHub
    </a>
  </footer>

  <script>
  document.getElementById('go').onclick = async () => {
    const url = document.getElementById('url').value.trim();
    const format = document.getElementById('format').value;
    const loading = document.getElementById('loading');

    if (!url) {
      Swal.fire({
        icon: 'warning',
        title: 'Oops!',
        text: 'Masukkan URL TikTok terlebih dahulu.',
        background: '#0f0f1a',
        color: '#e5e7eb'
      });
      return;
    }

    loading.classList.remove('hidden');

    try {
      if (format === 'mp4') {
        const res = await fetch(`/download?url=${encodeURIComponent(url)}`);
        const data = await res.json();

        if (!data.download_url) {
          throw new Error('Link download tidak ditemukan');
        }

        const a = document.createElement('a');
        a.href = data.download_url;
        a.download = 'tiktok_video_no_wm.mp4'; 
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);

      } else {
        // üéµ MP3 ‚Üí backend kirim file
        window.location.href =
          `/download?url=${encodeURIComponent(url)}&format=mp3`;
      }
      
    } catch (err) {
      Swal.fire({
        icon: 'error',
        title: 'Gagal',
        text: err.message,
        background: '#0f0f1a',
        color: '#e5e7eb'
      });
    } finally {
      setTimeout(() => loading.classList.add('hidden'), 3000);
    }
  };
  </script>
</body>
</html>
